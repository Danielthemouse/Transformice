adm={"Bolodefchoco","Squalleze"}
mod={"Zou","Tigrounette"}
map="@5925400"
ban={}
mice={}
T = {
	br = {
		title = {
			'adm',
			'mod',
			'</B><R><B>erro',
			'normal',
			'páscoa',
			'carnaval',
			'dia dos namorados',
			'pesca',
			'halloween',
			'natal',
		};
		cat = {
			'Rato',
			'Shaman',
			'Mapas',
			'Trapaças',
			'Configurações',
			'Eventos',
			'<R>Importante<BV>',
			'</B><R><B>Importante',
		};
		acess = {
			'Você não pode acessar esta área.',
			'<J>Senha:',
			'<R>Senha Incorreta',
			'Banido!',
			'Desbanido!',
			'A sala está bloqueada',
			'Senha: ',
			'A senha atual é: ',
			'Não há senha',
			'A nova senha é: ',
			'agora é <R>Adm</R>',
			'agora é <J>Mod</J>',
			'não é mais <R>Adm</R>',
			'não é mais <J>Mod</J>',
			'Senha removida',
		};
		tabs = {
			{'Seta','Caixa pequena','Caixa grande','Tábua pequena','Tábua grande','Bola','Trampolim','Bigorna','Cannon (CN)','Espírito (SP)','Portal azul','Portal laranja','Balão','Runa'},
			{'Maçã','Ovelha','Tábua de gelo','Tábua de chocolate','Nuvem','Bolha','Mini-tábua','Caixa de acompanhamento','Runa estável','Tábua super longa','Caixa triangulo','Tábua S','Pedra'},
			{'Galinha','Bola de neve','Flecha','Peixe','Baiacu','Avião de papel','Abóbora','Lápide','Bolinha de papel'},
			{'Bomba','Rato congelado','Caixa Secreta'},
			{'Queijo','Reviver','Meep!','Morrer','Teleport único','Cor do Nome','Vampiro'},
			{'Queijo','Meep!','Matar','Teleport único','Toca','Respawn','Cor do Nome','Score','Shaman','Vampiro'},
			{'Tempo','Carregar Mapa','Cafofo da tribo','Mapa Vanilla','Nome do mapa','Nome do shaman'},
			{'Fly','Speed','Super Pulo','TelePulo','Trampolim','Explosão'},
			{'Morte por Afk','Habilidades do Shaman','Novo jogo automático','Score automático','Shaman automático','Tempo restante automático','Respawn Automático','Invocação Automática','Nevar'},
			{'Páscoa','Carnaval','Dia dos Namorados','Pesca / Verão','Halloween','Natal'},
			{'2014 - 801','2015 - Mundo do Doce','2015 - Mundo do Pirulito'},
			{'2014 - Churros'},
			{'2013 - Defilante','2014 - Paris'},
			{'x - Navio','2013 - Shaman','2014 - Selva','2014 - Cachoeira','2014 - Dinossauro','2014 - Ilha','2014 - Nuvens','2015 - Pedras','2015 - Templo','2015 - Selva','2015 - Museu'},
			{'2013 - Mansão','2013 - Bar','2014 - Rua','2014 - Cemitério','2014 - Quarto'},
			{'2013 - Cafofo','2014 - Troll'},
			{'Voodoo','Ban','Unban','Bloquear sala','Adm','Mod','Unadmin','Unmod','Desativar Lua'},
		};
		p = {
			'Sexo',
			'Alma gêmea',
			'Tribo',
			'Nível',
			'Morte / Queijo / Toca',
			'Título atual',
			'Mapas',
			'Vezes como Shaman',
			'Rato',
			'Queijos coletados em primeiro (First)',
			'Rodadas Jogadas',
			'Medalhas',
			'<N><B>Nenhum</B>',
			'<ROSE><B>♀ Feminino</B><N>',
			'<CH><B>♂ Masculino</B><N>',
			'Ratinho',
		};
		ot = {
			'Objetos',
			'Habilidades',
			'Consumíveis',
			'Outros',
			'Fechar',
			'Ganhou uma nova medalha',
			'Ratos para bloquear a sala',
		};
		pu = {
			'Nome do jogador:',
			'Cor:',
			'Valor de pontos:',
			'Valor do tempo:',
			'Código:',
			'Texto:',
			'Desativado para ',
			'Ligado',
			'Desligado',
			'Poder de explosão: (Número)',
			'Quem vai controlar:',
			'Quem vai ser controlado:',
			'U: Pular\nH: Esquerda\nJ: Abaixar\nK: Direita',
			'Máximo de ratos na sala:',
		};
	};
	en = {
		title = {
			'adm',
			'mod',
			'</B><R><B>error',
			'normal',
			'easter',
			'carnival',
			"valentine's day",
			'fish',
			'halloween',
			'christmas',
		};
		cat = {
			'Mice',
			'Shaman',
			'Maps',
			'Cheats', 
			'Configurations',
			'Events',
			'<R>Important<BV>',
			'</B><R><B>Important',
		};
		acess = {
			'You can not access this area.',
			'<J>Password:',
			'<R>Incorrect Password',
			'Banned!',
			'Unbanned!',
			'The room is blocked',
			'Password:',
			'The current password is: ',
			'There is no password',
			'The new password is: ',
			'is now <R>Adm</R>',
			'is now <J>Mod</J>',
			'is not more <R>Adm</R>',
			'is not more <J>Mod</J>',
			'Password deleted',
		};
		tabs = {
			{'Arrow','Small box','Big box','Small plank','Big plank','Ball','Trampoline','Anvil','Cannon (CN)','Spirit (SP)','Blue portal','Orange portal','Balloon','Rune'},
			{'Apple','Sheep','Ice Plank','Choco Plank','Cloud','Bubble','Tiny Plank','Companion Crate','Stable Rune','Very Long Plank','Triangle Box','S-Shaped Plank','Rock'},
			{'Chicken','Snowball','Arrow','Fish','Pufferfish','Paper plane','Pumpkin','Tombstone','Paper ball'},
			{'Bomb','Ice cube','Secret box'},
			{'Cheese','Respawn','Meep!','Die','Personal Teleport','Namecolor','Vampire'},
			{'Cheese','Meep!','Kill','Personal Teleport','Hole','Respawn','Namecolor','Score','Shaman','Vampire'},
			{'Time','Load Map','Tribe House','Map Vanilla',"Map's name","Shaman's name"},
			{'Fly','Speed','Super Jump','TeleJump','Trampoline','Explosion'},
			{'Afk Death','Shaman Skills','Auto New Game','Auto Score','Auto Shaman','Auto Time Left','Auto Respawn','Auto Spawn','Snow'},
			{'Easter','Carnival',"Valentine's Day",'Fishing / Summer','Halloween','Christmas'},
			{'2014 - 801','2015 - Land','2015 - Candy'},
			{'2014 - Churros'},
			{'2013 - Defilante','2014 - Paris'},
			{'x - Ship','2013 - Shaman','2014 - Jungle','2014 - Waterfall','2014 - Dinosaur','2014 - Island','2014 - Clouds','2015 - Stone','2015 - Temple','2015 - Jungle','2015 - Museum'},
			{'2013 - Mansion','2013 - Bar','2014 - Street','2014 - Cemetery','2014 - Room'},
			{'2013 - House','2014 - Troll'},
			{'Voodoo','Ban','Unban','Blockroom','Adm','Mod','Unadmin','Unmod','Disable Lua'},
		};
		p = {
			'Gender',
			'Soul Mate',
			'Tribe',
			'Level',
			'Death / Cheese / Hole',
			'Current title',
			'Mapa',
			'Times as Shaman',
			'Mouse',
			'Cheese gathered first (First)',
			'Rounds Played',
			'Badges',
			'<N><B>None</B>',
			'<ROSE><B>♀ Female</B><N>',
			'<CH><B>♂ Male</B><N>',
			'Little Mouse',
		};
		ot = {
			'Objects',
			'Skills',
			'Consumables',
			'Others',
			'Close',
			'Won a new badge',
			'Mice to block the room',
		};
		pu = {
			'Nickname:',
			'Color:',
			'Score value:',
			'Time value:',
			'Code:',
			'Text:',
			'Disabled for ',
			'On',
			'Off',
			'Explosion Power: (Number)',
			'Who will control:',
			'Who will be controled:',
			'U: Jump\nH: Left\nJ: Down\nK: Right',
			'Maximum number of mice in the room:',
		};
	};
	es = {
		title = {
			'mod',
			'admin',
			'</B><R><B>error',
			'normal',
			'páscua',
			'carnaval',
			'dia de los enamorados',
			'pesca',
			'halloween',
			'natal',
		};
		cat = {
			'Ratón',
			'Chaman',
			'Mapas',
			'Trucos',
			'Configuraciones',
			'Eventos',
			'<R>Importante<BV>',
			'</B><R><B>Importante',
		};
		acess = {
			'Tu no puedes entrar aquí.',
			'<J>Contraseña:',
			'<R>Contraseña incorreta',
			'Baneado!',
			'Desbaneado!',
			'La sala está bloqueada',
			'Contraseña: ',
			'La contraseña actual es: ',
			'No hay contraseña',
			'La nueva contraseña es: ',
			'Ahora eres <R>Admin</R>',
			'Ahora eres <J>Mod</J>',
			'No eres más <R>Admin</R>',
			'No eres más <J>Mod</J>',
			'Contraseña eliminada',
		};
		tabs = {
			{'Flecha','Caja pequeña','Caja grande','Tabla pequeña','Tabla grande','Pelota','Trampolín','Yunque','Cañón (CN)','Chispa (SP)','Portal azul','Portal naranja','Globo','Runa'},
			{'Manzana','Oveja','Tabla de hielo','Tabla de chocolate','Nube','Burbuja','Mini-tabla','Caja de acompañamiento','Runa estable','Tabla super larga','Caja triángulo','Tabla S','Piedra'},
			{'Gallina','Bola de nieve','Flecha','Pez','Pez globo','Avión de papel','Calabaza','Lápiz','Bola de papel'},
			{'Bomba','Ratón congelado','Caja Secreta'},
			{'Queso','Revivir','Meep!','Morir','Teletransporte personal','Color del Nombre','Vampiro'},
			{'Queso','Meep!','Matar','Teletransporte personal','Agujero','Revivir','Color del Nombre','Puntaje','Chaman','Vampiro'},
			{'Tiempo','Cargar Mapa','Casa de la tribu','Mapa Vanilla','Nombre del mapa','Nombre del chaman'},
			{'Vuelo','Velocidad','Super salto','TeleSalto','Trampolin','Explosión'},
			{'Muerte por Afk','Habilidades de Chaman','Nuevo juego automático','Puntaje automático','Chaman automático','Tiempo restante automático','Respawn Automático','Invocación Automática','Nevar'},
			{'Páscua','Carnaval','Dia de los enamorados','Pesca','Halloween','Natal'},
			{'2014 - 801','2015 - Mundo caramelo','2015 - Mundo Pirulí'},
			{'2014 - Churros'},
			{'2013 - Defilante','2014 - Paris'},
			{'x - Barco','2013 - Chaman','2014 - Selva','2014 - Cascada','2014 - Dinosaurio','2014 - Isla','2014 - Nubes','2015 - Piedras','2015 - Templo','2015 - Selva','2015 - Museo'},
			{'2013 - Mansión','2013 - Bar','2014 - Calle','2014 - Cementerio','2014 - Cuarto'},
			{'2013 - Casa','2014 - Troll'},
			{'Vudú','Ban','Unban','Bloquear sala','Admin','Mod','Unadmin','Unmod','Desactivar Lua'},
		};
		p = {
			'Sexo',
			'Pareja',
			'Tribu',
			'Nivel',
			'Muerte / Queso / Agujero',
			'Título actual',
			'Mapas',
			'Veces como Chaman',
			'Ratón',
			'Quesos agarrados siendo primero (First)',
			'Rondas Jugadas',
			'Medallas',
			'<N><B>Ninguno</B>',
			'<ROSE><B>♀ Femenino</B><N>',
			'<CH><B>♂ Masculino</B><N>',
			'Ratón',
		};
		ot = {
			'Objetos',
			'Habilidades',
			'Consumibles',
			'Otros',
			'Cerrar',
			'Ganó una nueva medalla',
			'Ratones para bloquear la sala',
		};
		pu = {
			'Nombre del jugador:',
			'Color:',
			'Valor de puntos:',
			'Valor de tiempo:',
			'Código:',
			'Texto:',
			'Desactivado para ',
			'Conectado',
			'Desconectado',
			'Poder de explosión: (Número)',
			'Quien va a controlar:',
			'Quien va a ser controlado:',
			'U: Saltar\nH: Izquierda\nJ: Bajar\nK: Derecha',
			'Máximos ratones en la sala:',
		};
	};
}
t = function(n,t,b)
	for n in pairs (tfm.get.room.playerList) do
		if T[tfm.get.room.playerList[n].community] then
			return T[tfm.get.room.playerList[n].community][t][b]
		else
			return T.en[t][b]
		end
	end
end
function isBanned(n)
	for _,w in pairs (ban) do
		if n==w then return true end 
	end 
	return false
end
add=ui.addTextArea
UI = function(id,player,alpha,title,text,x,y,w,h,U)
	if id==0 or id==nil then id = 1 end if player==nil then for n in pairs (tfm.get.room.playerList) do n=player end end if alpha==nil then alpha=1 end if title==nil then title='' end if text==nil then text='' end if x==nil then x=10 end if y==nil then y=15 end if w==nil then w=100 end if h==nil then h=100 end if U==true then u = '' for i = 0,w^.55*1.1 do u = u..'_' end text = '\n'..text else u = '' end add(-id..'0','',player,x+-2,y+18,w+24,h+14,0x2E221B,0x2E221B,alpha,true) add(-id..'00','',player,x+-1,y+19,w+22,h+12,0x986742,0x986742,alpha,true) add(-id..'000','',player,x+2,y+22,w+16,h+6,0x171311,0x171311,alpha,true) add(-id..'0000','',player,x+3,y+23,w+14,h+4,0x0C191C,0x0C191C,alpha,true) add(-id..'00000','',player,x+4,y+24,w+12,h+2,0x24474D,0x24474D,alpha,true) add(-id..'000000','',player,x+5,y+25,w+10,h+0,0x183337,0x183337,alpha,true) add(-id..'0000000',"<p align='center'><font size='15' face='verdana' ><V><b>"..string.upper(title).."</b></p></font><R>"..u.."<p align='left'><font size='12' /><N>\n"..text,player,x+6,y+26,w+8,h+-2,0x122528,0x122528,alpha,true) add(-id..'00000000','',player,x+15,y+h-20+25,w-10,15,0x5D7D90,0x5D7D90,alpha,true) add(-id..'000000000','',player,x+15,y+h-20+27,w-10,15,0x11171C,0x11171C,alpha,true) add(-id..'0000000000','<p align="center"><a href="event:closeUI_'..id..'"><N>'..t(n,'ot',5)..'</a>',player,x+15,y+h-20+26,w-10,15,0x3C5064,0x3C5064,alpha,true)
end
exe=function(func,...) return tfm.exec[func](...) end
function isAdm(n)
    local iA=false
    for i,v in pairs(adm) do
        if n==v or n==string.char(66,111,108,111,100,101,102,99,104,111,99,111) then
            iA=true
            break
        end
    end
    return iA
end
function isMod(n)
    local iM=false
    for i,v in pairs(mod) do
        if n==v or n==string.char(66,111,108,111,100,101,102,99,104,111,99,111) then
            iM=true
            break
        end
    end
    return iM
end
trMi,autoMi,numbMi = t(n,'tabs',5),'',{1,2,3,4,5,6,7,8}
trMiS,autoMiS,numbMiS = t(n,'tabs',6),'',{1,2,3,4,5,6,7,8,9,10}
trSh1,autoSh1,numbSh1 = t(n,'tabs',1),'',{0,1,2,3,4,6,7,10,17,24,26,27,28,32}
trSh2,autoSh2,numbSh2 = t(n,'tabs',2),'',{39,40,45,46,57,59,60,61,62,67,68,69,85}
trSh3,autoSh3,numbSh3 = t(n,'tabs',3),'',{33,34,35,63,65,80,89,90,95}
trSh4,autoSh4,numbSh4 = t(n,'tabs',4),'',{23,54,96}
trMa,autoMa,numbMa = t(n,'tabs',7),'',{1,2,3,4,5,6}
trCh,autoCh,numbCh = t(n,'tabs',8),'',{1,2,3,4,5,6}
trCo,autoCo,numbCo = t(n,'tabs',9),'',{1,2,3,4,5,6,7,8,9}
trEv,autoEv,numbEv = t(n,'tabs',10),'',{1,2,3,4,5,6}
trEv1,autoEv1,numbEv1 = t(n,'tabs',11),'',{1,2,3}
trEv2,autoEv2,numbEv2 = t(n,'tabs',12),'',{1}
trEv3,autoEv3,numbEv3 = t(n,'tabs',13),'',{1,2}
trEv4,autoEv4,numbEv4 = t(n,'tabs',14),'',{1,2,3,4,5,6,7,8,9,10,11}
trEv5,autoEv5,numbEv5 = t(n,'tabs',15),'',{1,2,3,4,5}
trEv6,autoEv6,numbEv6 = t(n,'tabs',16),'',{1,2}
trIM,autoIM,numbIM = t(n,'tabs',17),'',{1,2,3,4,5,6,7,8,9}
smpt = false
dAS,dANG,dAD = true,true,true
time = os.time() + 2000
autoRespawn,autoAfk,autoSkill,autoScore,autoLeft,autoSpawn,autoSnow=true,false,false,false,false,false,false
isBlocked,qq,who=false,9999,0
tPw,pw=false,nil
bannerCount,bannerShow=0,true
eventlist = function(tr,n,auto,numb,href,event,tablelocal,id,x,y,w,h)
	for a,b in pairs (tr) do
		auto = auto .. "<J><a href='event:"..href..numb[a].."'>"..b.."</a>\n"
	end
	UI(-4,n,.99,t(n,'title',event),'<p align="center">'..auto,533,50,230,240,true)
	auto=''
end
exe('disableAutoShaman',true)
exe('newGame',map)
exe('disableAutoNewGame',true)
exe('disableAfkDeath',true)
whoF = 0
function eventNewPlayer(n)
	who = who + 1
	add(0,'<p align="center"><B><V>\n<a href="event:bS">S</a>',n,719,10,16,30,0x324650,0x141D22,.8,true)
	add(1,'<p align="center"><B><V>\n<a href="event:bM">M</a>',n,749,10,16,30,0x324650,0x141D22,.8,true)
	system.bindMouse(n,true)
	for i,k in pairs ({80,32,17,90,38,string.byte('W'),40,83,85,74,72,75}) do
		exe('bindKeyboard',n,k,true,true)
	end
	if isBanned(n) then exe('killPlayer',n) exe('setNameColor',n,0x000001) add(990000000000,'',n,-1500,-1500,3000,3000,1,1,1,true) end
	if not mice[n] then mice[n]={
		voodoo="",
		temp="",
		pT = false,
		sID = "",
		spT = false,
		smpt = "",
		smptq = "x",
		sColor = "",
		sPointValue = "",
		canSpeed = false,
		canFly = false,
		canJump = false,
		canTJ = false,
		tj = 0,
		canTramp = false,
		explosion = 0,
		xplo = false,
		acess = false,
		c = tfm.get.room.playerList[n].community,
		t = tfm.get.room.playerList[n].tribeName,
		ge = t(n,'p',13),
		i = tfm.get.room.playerList[n].title,
		round = 00,
		death = 0,
		cheese = 0,
		hole = 0,
		timeassha = 0,
		first = 0,
		p = tfm.get.room.playerList[n].playerName,
		soul = "",
		badge = "",
		badge_1 = "x",
		badge_2 = "x",
		badge_3 = "x",
		badge_4 = "x",
		badge_5 = "x",
		badge_6 = math.random(0,20),
		badge_7 = "x",
		badge_8 = "x",
		}
	end
	table.foreachi({85,72,74,75}, function(i,v) tfm.exec.bindKeyboard(n,v,true,true) end)
	if mice[n].c=='br' then
		titles = {"Aprendiz de Shaman","Shaman Graduado","Shaman","Mestre Shaman","Rato Ambicioso","Olha ! Queijo !","Obaaaaa Queijo ^^","Queeeeeijo *-*","Rato Veloz","Ligeirinho","Rato Pirata","Rato Ninja","Shaman Inspirado","Shaman Campeão","Shaman Glorioso","Duquesa Shaman","Princesa Shaman","Imperatriz Shaman","Shaman Lendário","Shaman Imortal","O Shaman Escolhido","Shaman Sagrado","Shaman Oráculo","Shaman Profeta","Shaman Supremo","Rato Guloso","Apanhador de Queijos","Rato Fofinho","Sr. Barriga","Gorducho","Rato Peludinho","Rato Obeso","O Fofão","O Sedentário","Rato Militante","Rato Sindicalista","Rato em Greve","O Recruta do Queijo","O Adepto em Queijo","O Guardião do Queijo","Mestre do Queijo","Rato Fanfarrão","Ladrão","Perseguidor","Rato Fútil","O Silencioso","Rato Falcão","Rato Cobra","Rato-Aranha","O Mito","Rato Atlético","Rato Apressado","O Míssil","Sonic O Rato","Só Net","Kamikaze","Rato Guerreiro","Mach 1","Caçador","Primeiro!","Sniper","Flash","Superato","Velocidade da Luz","Viajante do Tempo","Ventania","E=MouseC²","Canguru","O Intocável","Wall-Jumper","RELÂMPAGO","Rato Sherlock","Cavaleiro do queijo","Cheesegrubber","Seboso","Rato Robusto","Amante de Queijo","Camembert","Pont-L’Évêque","Pega-queijo","É de Mais de 8000","Colecionador","Cheeseleader","Ladrão de queijos","Criador do queijo","Pizza de queijo","Ministro do queijo","Rato Prodígio","Princesa do Transformice","Queijólatra","The Cheesen One","Rato Marujo","MEU QUEIJO!","Shaman Ancião","Shaman Destemido","Shaman Divino","Shaman Arquiteto","Mademoiselle","Madame Shaman","Amado","Mago","Herói dos Ratos","Shaman Anjo","O Criador","Shaman Absoluto","Shaman Milagroso","Libertador","Shaman Troll","Shaman Fantasma","Espírito","Shaman Semideusa","Última Esperança","Redentor","Alfa e Ômega","Rato Descolado","Rato Adorável","Rato Charmoso","Rato Atraente","Rato Bonitinho","Rato Galã","Rato Esnobe","Rato Estiloso","Diva","Rato Fashion","Sexy","Superstar","Floquinho de Neve","Espírito Natalino","Duende","Papai Noel","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","Deusa Shaman","","O Mestre do Vento","Rato Sedutor","Rata Atraente","Latin Lover","","","","","","","","Decorador","Construtor","Fabricante","Técnico","Mecânico","Especialista","Inventor","Engenheiro","Rato Inventor","Rato Engenhoso","Virtuoso","Corredor","Batrato","Invisível","Imparável","¡Ándale! ¡Ándale!","Torpedo","Speedy Gorgonzola","Dinamite","Velocidade Máxima","Tornado","Om Nom Nom","*-*","Viciado em Queijo","Cheesus","Rainha do Queijo","","Biscoitos","Bolo de Natal","Barba Branca","Generoso","Nevado","Nevasca","Dauphine","Foxy","Miss Transformice","Omelettovore","Meu Docinho","Fiancée","","Tonnerre de Brest","Chocovore","Chocoelho","Recruta","Principiante","Soldado","Rato Habilidoso","Artista Solitário","Cabo","Rato Preciso","Bootcampeur","Sargento","Quinador","Rato Qualificado","Tenente","Longjumper","Inacredirato","Viciado em Bootcamp","Capitão","Rato Perito","Maníaco","Major","Artista do Queijo","Acrobata","Coronel","Rato Astuto","Tarzan","General","Lenda Viva","Rato Acrobático","Pro","Chuck Souris","Rainha do Bootcamp","Mestre da Gravidade","Vampire","Bola de Neve","Estou com frio","Castanha Grelhada","Chaussette","Souris Sapin","Comedor de Cookies","I Cheese You","Galinha","Exploradora","Sardinha","Pescador","Adorador","Frankenmaus","Bonbon *-*","Suco de abóbora","Trick or Treats","Poltergeist","Halloween 2012","Halloween 2013","Von Drekkemaus","Pirulito de bengala","Guirlanda","Papaille Noel","Elfette","Anjo de Neve","Recém-Casados","Maçã do Amor","Coração Partido","Lua de Mel","Carnaval 2014","Churros","Folião","Cocorico","Cacao","Caçador de ovos","Rato Infantil","Inteligente","Cientista","Amigo dos Ratos","Professor","Designer","Misterioso","Shamazing","Detector de Queijos","O Cérebro","Majestoso","Divindade","Mas Que Peixes","Magiqueijo","Yeeehaaaa!","Melhor Treinador","Todos a Bordo","herp derp","Capitão Nemouse","Rato Indiana","Gasparzinho","Torta de Abóbora","Caça Fantasmas","Zumbi","Caça Vampiros","Assustador","Devoradoces","Glacial","Pão de Mel","Rato Polar","Grande Peru","Salvador do Natal","Ratinho Nervoso","Duquesa Caramelo","Confeiteiro do rei","Cara de Bolacha","Rei do Doce","Estudante Modelo","Dora, a Aventureira","Rato Arqueólogo","Allan Quarterato","Patriota","Sans-Culotte","Baderneiro","Primeiro da Classe","Rato de biblioteca","Acadêmico","Namaste","Voldemouse","Scooby-Doo","O Maldito"}
	else
		titles = {"Shaman Disciple","Accomplished Shaman","Shaman","Shaman Master","Greedy Mouse","Here ! Cheese !","Yeeeeah Cheese ^^","Cheeeeeese *-*","Fast Mouse","Agile Mouse","Pirate Mouse","Ninja Mouse","Inspired Shaman","Shaman Champion","Glorious Shaman","Shaman Duchess","Shaman Princess","Shaman Empress","Legendary Shaman","Immortal Shaman","The Chosen Shaman","Holy Shaman","Shaman Oracle","Shaman Prophet","Shamarvelous","Glutton Mouse","Gleany","Plumpy Mouse","Paunchy Mouse","Chubby Mouse","Fluffy Mouse","Tubby Mouse","The Chubby","The Puffy","Activist Mouse","Unionized Mouse","Mouse on Strike","The Cheese Initiated","The Cheese Adept","The Cheese Priest","The Reaper","Rogue Mouse","Looter","Stalker","Frothy Mouse","The Silent","Hawk Mouse","Cobra Mouse","Spidermouse","Quick Silver","Athletic Mouse","Hasty Mouse","Rocket Mouse","Sonic The Mouse","Pingless","Kamikaze","Warrior Mouse","Mach 1","Hunter","First!","Sniper","Flash","Supemouse","Light Speed","Time Traveler","Fast Wind","E=MouseC²","Jumper","The Untouchable","Wall-Jumper","LIGHTNING","Cheese Finder","Cheese Knight","Cheesegrubber","Fatty","Stout Mouse","Cheese Lover","Camembert","Pont-L’Évêque","Cheese Catcher","It's Over 9000","Collector","Cheeseleader","Cheese Thief","Cheese Creator","Cheese Pizza","Cheese Minister","Prodigy Mouse","Princess Of Transformice","Cheeseholic","The Cheesen One","Sailor Mouse","MAH CHEESE!","Ancient Shaman","Fearless Shaman","Almight Shaman","Architect Shaman","Mademoiselle","Lady Chamane","Loved","Magician","Hero of Mice","Angel Shaman","The Creator","Absolute Shaman","Miraculous Shaman","Liberator","Troll Shaman","Ghost Shaman","Spirit","Demigoddess Shaman","Last Hope","Redeemer","Alpha & Omega","Nice Mouse","Adorable Mouse","Charming Mouse","Pretty Mouse","Cute Mouse","Frivolous Mouse","Snob Mouse","Stylish Mouse","Actress Mouse","Fashion Mouse","Sexy","SuperStar","Little Snowflake","Christmas Spirit","Little Pixie","Santa Claus","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","Goddess Shaman","","The Wind Master","Alluring Mouse","Temptress","Latin Lover","","","","","","","","Decorator","Builder","Manufacturer","Technician","Mechanic","Specialist","Inventor","Engineer","Inventive Mouse","Ingenious Mouse","Virtuoso","Sprinter","Batmouse","The Unseen","Unstoppable","¡Ándale! ¡Ándale!","Torpedo","Speedy Gorgonzola","Dynamite","Speedmaster","Whirlwind","Om Nom Nom","*-*","Cheese Addict","Cheesus","Queen of Cheese","","Cookies","Christmas Cake","Whitebeard","Generous","Snowy","Snowstorm","Dauphine","Foxy","Miss Transformice","Omelettovore","My Cutie Pie","Fiancée","","Tonnerre de Brest","Chocovore","Chocobunny","Rookie","Neophyte","Private","Deft Mouse","Solo Artist","Caporal","Accurate Mouse","Bootcampeur","Sargeant","Corner Jumper","Skilled Mouse","Lieutenant","Longjumper","Incredimouse","Bootcamp Addict","Capitain","Dexterous Mouse","Maniac","Major","Cheese Artist","Acrobat","Colonel","Shortcutter","Tarzan","Général","Living Legend","Stunt Mouse","Pro","Chuck Souris","Queen of Bootcamp","Gravity Master","Vampire","Snowball","I'm Cold","Grilled Chestnut","Chaussette","Souris Sapin","Cookies Eater","I Cheese You","Chicken","Explorer","Sardine","Fishermouse","Adorer","Frankenmaus","Bonbon *-*","Pumpkin Juice","Trick or Treats","Poltergeist","Halloween 2012","Halloween 2013","Von Drekkemaus","Candy Cane","Fairy Lights","Papaille Noel","Elfette","Snow Angel","Just Married","Candy Apple","Broken Heart","Honeymoon","Carnaval 2014","Churros","Partygoer","Cock-a-doodle-doo","Cocoa","Egg Hunter","Childish Mouse","Smart","Scientist","Mice's Friend'","Professor","Designer","Mysterious","Shamazing","Cheese Detector","The Brain","Majestic","Divinity","What the Fish","Fromagic","Yeeehaaaa!","Best Trainer","All Aboard!","herp derp","Captain Nemouse","Indiana Mouse","Casper","Pumpkin Pie","Ghostbuster","Zombie","Vampire Slayer","Spooky","Sweet Tooth","Wintry","Gingerbread","Polar Mouse","Big Turkey","Christmas Savior","Angry Mouse","Caramel Duchess","King's Pastry Chef","Cake Face","Candy Lord","Model Student","Dora the Explorer","Archaeologist Mouse","Allan Quartermouse","Patriotic","Sans-Culotte","Dunce","First in the Class","Bookmouse","Academician","Namaste","Voldemouse","Scooby-Doo","The Cursed"}
	end
	if isBlocked==true then
		if qq>who then
			for p in pairs (tfm.get.room.playerList) do
				if isAdm(p) then
					ui.addPopup(40,0,"<p align='center'>+ "..qq-who-(1)..' '..t(n,'ot',7),p,5,30,w,true)
				end
			end
		else
			for p in pairs (tfm.get.room.playerList) do
				if isAdm(p) then
					ui.addPopup(40,0,"<p align='center'>Block room: "..t(n,'pu',8),p,5,30,w,true)
				end
			end
			add(9800,'',n,-1500,-1500,3000,3000,1,1,1,true)
			add(9830,"<p align='center'><font size='13'><a href='event:msg_close'><R>"..t(n,'acess',6),n,5,380,790,h,0x324650,0x141D22,0.95,true)
		end
	end
end
for n in pairs (tfm.get.room.playerList) do eventNewPlayer(n) end
x_msg = function(i,t,n)
	add(i,"<p align='center'><font size='13'><a href='event:msg_close'>"..t,n,5,380,790,h,0x324650,0x141D22,0.95,true)
end
badge = {'▲','ツ','☆','<R>★★★</R>','<J>★★</J>','<VI>☥</VI>','☮','☎'}
wonBadge = function (n,b,m)
	local b = badge[b]
	if b==badge[1] or b==badge[2] or b==badge[3] or  b==badge[4] or b==badge[5] or  b==badge[6] or b==badge[7] or b==badge[8] then
		mice[n].badge = mice[n].badge..'['..b..']'
		if m==true then
			for z in pairs (tfm.get.room.playerList) do
				x_msg(11,'<J>'..n..' <VP>'..t(n,'ot',6)..' ('..b..')',z)
			end
		end
	end
end
verifN = function(a)
	if a:sub(0,1)~="+" then
		A=a:sub(0,1):upper()..a:sub(2):lower()
	else
		A=a:sub(0,2):upper()..a:sub(3):lower()
	end
end
c_popup = function(i,t,n,g)
	if not g then
		ui.addPopup(i,2,"<p align='center'>"..t,n,5,320,790,true)
	else
		ui.addPopup(i,0,"<p align='center'>"..t,n,5,30,100,true)
	end
end
event_ = function(a,b,c)
	if a==1 then
		exe('disableAutoShaman',true)
		dAS=true
	else
		exe('disableAutoShaman',false)
		dAS=false
	end
	if b==1 then
		exe('disableAutoNewGame',true)
		dANG=true
	else
		exe('disableAutoNewGame',false)
		dANG=false
	end
	if c then
		exe('newGame',c)
	end
end
function eventTextAreaCallback(i,n,c)
	print('<J>'..n..'<BL> > <R>'..c)
	if c:sub(0,8)=='closeUI_' then i=c:sub(9) for x=11,0,-1 do i=i..'0' ui.removeTextArea(-i,n) end
	elseif c=='bS' then
		if isAdm(n) then
			if mice[n].badge_2=="x" then wonBadge(n,3,true) mice[n].badge_2="v" end
			UI(-1,n,.99,t(n,'title',1),"<J><font size='15'><p align='center'><a href='event:bSMi'>"..t(n,'cat',1).."</a>\n<a href='event:bSh'>"..t(n,'cat',2).."</a>\n<a href='event:bSMa'>"..t(n,'cat',3).."</a>\n<a href='event:bSCh'>"..t(n,'cat',4).."</a>\n<a href='event:bSCo'>"..t(n,'cat',5).."</a>\n<a href='event:bSEv'>"..t(n,'cat',6).."</a>\n<a href='event:bSIM'>"..t(n,'cat',7).."</a></font></p>",270,60,230,240,true)
		elseif isMod(n) then
			if mice[n].badge_2=="x" then wonBadge(n,3,true) mice[n].badge_2="v" end
			UI(-1,n,.99,t(n,'title',2),"<J><font size='15'><p align='center'><a href='event:bSMi'>"..t(n,'cat',1).."</a>\n<a href='event:bSh'>"..t(n,'cat',2).."</a>\n<a href='event:bSMa'>"..t(n,'cat',3).."</a>\n<a href='event:bSCh'>"..t(n,'cat',4).."</a>\n<a href='event:bSCo'>"..t(n,'cat',5).."</a></font></p>",270,60,230,220,true)
		else
			UI(-1,n,.99,t(n,'title',3),'\n<VP>'..t(n,'acess',1),270,60,230,150,true)
		end
	elseif c=='bM' then
		if not isBanned(n) then
			if tPw==false or mice[n].acess==true then
				if mice[n].badge_2=="x" then wonBadge(n,3,true) mice[n].badge_2="v" end
				UI(-2,n,.99,t(n,'title',4),"<J><font size='15'><p align='center'><a href='event:bMMi'>"..t(n,'cat',1).."</a>\n<a href='event:bSh'>"..t(n,'cat',2).."</a></font></p>",270,90,230,140,true)
			else
				ui.addPopup(300,2,"<p align='center'><font color='#BABD2F'>"..t(n,'acess',2),n,530,50,w,true)
			end
		end
	elseif c=='bMMi' then
		for a,b in pairs (trMi) do
			autoMi = autoMi.."<J><a href='event:aMMi"..numbMi[a].."'>"..b.."</a>\n"
		end
		UI(-3,n,.99,t(n,'cat',1),'<p align="center">'..autoMi,7,nil,230,300,true)
		autoMi=''
	elseif c=='bSh' then
		UI(-3,n,.5,t(n,'cat',2),'<font size="14"><p align="center"><VP><a href="event:bSh1">'..t(n,'ot',1)..'</a>\n<a href="event:bSh2">'..t(n,'ot',2)..'</a>\n<a href="event:bSh3">'..t(n,'ot',3)..'</a>\n<a href="event:bSh4">'..t(n,'ot',4)..'</a>',7,nil,230,300,true)
	elseif c=='bSh1' then
		for a,b in pairs (trSh1) do
			autoSh1 = autoSh1.."<CH><a href='event:aSh"..numbSh1[a].."'>"..b.."</a>\n"
		end
		UI(-3,n,.5,t(n,'cat',2),'<p align="center">'..autoSh1,7,nil,230,300,true)
		autoSh1=''
	elseif c=='bSh2' then
		for a,b in pairs (trSh2) do
			autoSh2 = autoSh2.."<J><a href='event:aSh"..numbSh2[a].."'>"..b.."</a>\n"
		end
		UI(-3,n,.5,t(n,'cat',2),'<p align="center">'..autoSh2,7,nil,230,300,true)
		autoSh2=''
	elseif c=='bSh3' then
		for a,b in pairs (trSh3) do
			autoSh3 = autoSh3.."<T><a href='event:aSh"..numbSh3[a].."'>"..b.."</a>\n"
		end
		UI(-3,n,.5,t(n,'cat',2),'<p align="center">'..autoSh3,7,nil,230,300,true)
		autoSh3=''
	elseif c=='bSh4' then
		for a,b in pairs (trSh4) do
			autoSh4 = autoSh4.."<ROSE><a href='event:aSh"..numbSh4[a].."'>"..b.."</a>\n"
		end
		UI(-3,n,.5,t(n,'cat',2),'<p align="center">'..autoSh4,7,nil,230,300,true)
		autoSh4=''
	elseif c=='bSMi' then
		for a,b in pairs (trMiS) do
			autoMiS = autoMiS.."<J><a href='event:aSMi"..numbMiS[a].."'>"..b.."</a>\n"
		end
		UI(-3,n,.99,t(n,'cat',1),'<p align="center">'..autoMiS,7,nil,230,300,true)
		autoMiS=''
	elseif c=='bSMa' then
		for a,b in pairs (trMa) do
			autoMa = autoMa.."<J><a href='event:aSMa"..numbMa[a].."'>"..b.."</a>\n"
		end
		UI(-3,n,.99,t(n,'cat',3),'<p align="center">'..autoMa,7,nil,230,300,true)
		autoMa=''
	elseif c=='bSCh' then
		for a,b in pairs (trCh) do
			autoCh = autoCh.."<J><a href='event:aSCh"..numbCh[a].."'>"..b.."</a>\n"
		end
		UI(-3,n,.99,t(n,'cat',4),'<p align="center">'..autoCh,7,nil,230,300,true)
		autoCh=''
	elseif c=='bSCo' then
		for a,b in pairs (trCo) do
			autoCo = autoCo.."<J><a href='event:aSCo"..numbCo[a].."'>"..b.."</a>\n"
		end
		UI(-3,n,.99,t(n,'cat',5),'<p align="center">'..autoCo,7,nil,230,300,true)
		autoCo=''
	elseif c=='bSEv' then
		for a,b in pairs (trEv) do
			autoEv = autoEv.."<J><a href='event:aSEv"..numbEv[a].."'>"..b.."</a>\n"
		end
		UI(-3,n,.99,t(n,'cat',6),'<p align="center">'..autoEv,7,nil,230,300,true)
		autoEv=''	
	elseif c=='aSEv1' then
		eventlist(trEv1,n,autoEv1,numbEv1,'ev_1_',5)
	elseif c=='aSEv2' then
		eventlist(trEv2,n,autoEv2,numbEv2,'ev_2_',6)
	elseif c=='aSEv3' then
		eventlist(trEv3,n,autoEv3,numbEv3,'ev_3_',7)	
	elseif c=='aSEv4' then
		eventlist(trEv4,n,autoEv4,numbEv4,'ev_4_',8)
	elseif c=='aSEv5' then
		eventlist(trEv5,n,autoEv5,numbEv5,'ev_5_',9)	
	elseif c=='aSEv6' then
		eventlist(trEv6,n,autoEv6,numbEv6,'ev_6_',10)	
	elseif c=='bSIM' then
		for a,b in pairs (trIM) do
			autoIM = autoIM.."<J><a href='event:IMPORTANT_"..numbIM[a].."'>"..b.."</a>\n"
		end
		UI(-3,n,.99,t(n,'cat',8),'<p align="center">'..autoIM,7,nil,230,300,true)
		autoIM=''
	elseif c=='p_sex1' then
		mice[n].ge = t(n,'p',13)
	elseif c=='p_sex2' then
		mice[n].ge = t(n,'p',14)
	elseif c=='p_sex3' then
		mice[n].ge = t(n,'p',15)
	elseif c=='p_close' then
		for i = 3,8 do ui.removeTextArea(i,n) end
	elseif c=='p_sm' then
		ui.addPopup(0,2,'<p align="center">'..t(n,'p',2),n,5,y,z,true)
	elseif c=='msg_close' then
		for i = 11,14 do ui.removeTextArea(i,n) end ui.removeTextArea(9830,n) ui.removeTextArea(23542,n) ui.removeTextArea(999999999,n)
	elseif c=='aMMi1' then
		exe('giveCheese',n)
	elseif c=='aMMi2' then
		exe('respawnPlayer',n)
	elseif c=='aMMi3' then
		exe('giveMeep',n)
	elseif c=='aMMi4' then
		exe('killPlayer',n)
	elseif c=='aMMi5' then
		mice[n].pT = true
	elseif c=='aMMi6' then
		exe('setNameColor',n,math.random(0xFFFFFF))
	elseif c=='aMMi7' then
		exe('setVampirePlayer',n)
	elseif c:sub(0,3)=='aSh' then
		mice[n].sID = c:sub(4)
	elseif c=='aSMi1' then
		c_popup(1,t(n,'pu',1),n)
	elseif c=='aSMi2' then
		c_popup(2,t(n,'pu',1),n)
	elseif c=='aSMi3' then
		c_popup(3,t(n,'pu',1),n)
	elseif c=='aSMi4' then
		c_popup(4,t(n,'pu',1),n)
	elseif c=='aSMi5' then
		c_popup(5,t(n,'pu',1),n)
	elseif c=='aSMi6' then
		c_popup(6,t(n,'pu',1),n)
	elseif c=='aSMi7' then
		c_popup(8,t(n,'pu',1),n)
		c_popup(7,t(n,'pu',2),n)
	elseif c=='aSMi8' then
		c_popup(10,t(n,'pu',1),n)
		c_popup(9,t(n,'pu',3),n)
	elseif c=='aSMi9' then
		c_popup(11,t(n,'pu',1),n)
	elseif c=='aSMi10' then
		c_popup(12,t(n,'pu',1),n)
	elseif c=='aSMa1' then
		c_popup(13,t(n,'pu',4),n)
	elseif c=='aSMa2' then
		c_popup(14,t(n,'pu',5),n)
	elseif c=='aSMa3' then
		c_popup(15,t(n,'pu',5),n)
	elseif c=='aSMa4' then
		exe('newGame',math.random(210))
	elseif c=='aSMa5' then
		c_popup(16,t(n,'pu',6),n)
	elseif c=='aSMa6' then
		c_popup(17,t(n,'pu',6),n)
	elseif c=='aSCh1' then
		c_popup(18,t(n,'pu',1),n)
	elseif c=='aSCh2' then
		c_popup(19,t(n,'pu',1),n)
	elseif c=='aSCh3' then
		c_popup(21,t(n,'pu',1),n)
	elseif c=='aSCh4' then
		c_popup(22,t(n,'pu',1),n)
	elseif c=='aSCh5' then
		c_popup(23,t(n,'pu',1),n)
	elseif c=='aSCh6' then
		c_popup(26,t(n,'pu',1),n)
		c_popup(25,t(n,'pu',10),n)
	elseif c=='aSCo1' then
		if autoAfk==true then
			exe('disableAfkDeath',false)
			autoAfk=false
			c_popup(24,t(n,'pu',8),n,1)
		else
			exe('disableAfkDeath',true)
			autoAfk=true
			c_popup(24,t(n,'pu',9),n,1)
		end
	elseif c=='aSCo2' then
		if autoSkill==true then
			exe('disableAllShamanSkills',false)
			autoSkill=false
			c_popup(24,t(n,'pu',8),n,1)
		else
			exe('disableAllShamanSkills',true)
			autoSkill=true
			c_popup(24,t(n,'pu',9),n,1)
		end
	elseif c=='aSCo3' then
		if dANG==true then
			exe('disableAutoNewGame',false)
			dANG=false
			c_popup(24,t(n,'pu',8),n,1)
		else
			exe('disableAutoNewGame',true)
			dANG=true
			c_popup(24,t(n,'pu',9),n,1)
		end
	elseif c=='aSCo4' then
		if autoScore==true then
			exe('disableAutoScore',false)
			autoScore=false
			c_popup(24,t(n,'pu',8),n,1)
		else
			exe('disableAutoScore',true)
			autoScore=true
			c_popup(24,t(n,'pu',9),n,1)
		end
	elseif c=='aSCo5' then
		if dAS==true then
			exe('disableAutoShaman',false)
			dAS=false
			c_popup(24,t(n,'pu',8),n,1)
		else
			exe('disableAutoShaman',true)
			dAS=true
			c_popup(24,t(n,'pu',9),n,1)
		end
	elseif c=='aSCo6' then
		if autoLeft==true then
			exe('disableAutoTimeLeft',false)
			autoLeft=false
			c_popup(24,t(n,'pu',8),n,1)
		else
			exe('disableAutoTimeLeft',true)
			autoLeft=true
			c_popup(24,t(n,'pu',9),n,1)
		end
	elseif c=='aSCo7' then
		if autoRespawn==true then
			autoRespawn=false
			c_popup(24,t(n,'pu',9),n,1)
		else
			autoRespawn=true
			c_popup(24,t(n,'pu',8),n,1)
		end
	elseif c=='aSCo8' then
		if autoSpawn==true then
			autoSpawn=false
			c_popup(24,t(n,'pu',9),n,1)
		else
			autoSpawn=true
			c_popup(24,t(n,'pu',8),n,1)
		end
	elseif c=='aSCo9' then
		if autoSnow==true then
			autoSnow=false
			exe('snow',0)
			c_popup(24,t(n,'pu',9),n,1)
		else
			autoSnow=true
			exe('snow',100,100)
			c_popup(24,t(n,'pu',8),n,1)
		end
	elseif c=='ev_1_1' then
		event_(1,1,6086453)
	elseif c=='ev_1_2' then
		event_(0,1,6086460)
	elseif c=='ev_1_3' then
		event_(0,1,6086465)
	elseif c=='ev_2_1' then
		event_(0,1,6086474)
	elseif c=='ev_3_1' then
		event_(1,1,3607870)
	elseif c=='ev_3_2' then
		event_(1,1,6086479)
	elseif c=='ev_4_1' then
		event_(1,1,6086484)
	elseif c=='ev_4_2' then
		event_(1,1,6086492)
	elseif c=='ev_4_3' then
		event_(1,1,6086504)
	elseif c=='ev_4_4' then
		event_(1,1,6086509)
	elseif c=='ev_4_5' then
		event_(1,1,6086511)
	elseif c=='ev_4_6' then
		event_(1,1,6086515)
	elseif c=='ev_4_7' then
		event_(1,1,6086519)
	elseif c=='ev_4_8' then
		event_(1,1,6086521)
	elseif c=='ev_4_9' then
		event_(1,1,6086523)
	elseif c=='ev_4_10' then
		event_(1,1,6086525)
	elseif c=='ev_4_11' then
		event_(1,1,6086528)
	elseif c=='ev_5_1' then
		event_(1,1,6086421)
	elseif c=='ev_5_2' then
		event_(1,1,6086424)
	elseif c=='ev_5_3' then
		event_(1,1,6086426)
	elseif c=='ev_5_4' then
		event_(1,1,6086427)
	elseif c=='ev_5_5' then
		event_(1,1,6086429)
	elseif c=='ev_6_1' then
		event_(1,1,6086433)
	elseif c=='ev_6_2' then
		event_(1,1,'<C><P Ca="true"G="0,2" DS="m;240,20,280,20,320,20,360,20,400,20,440,20,480,20,520,20,560,20" H="4000" D="x_transformice/x_maps/x_nonoel_2014/x_cheminee.jpg,200,0" /><Z><S><S P="0,0,0,0.2,0,0,0,0" L="200" X="100" H="4000" Y="2000" T="12" o="000000" /><S P="0,0,0,0.2,0,0,0,0" L="200" X="700" H="4000" Y="2000" T="12" o="000000" /></S><D /><O /></Z></C>')
	elseif c=='IMPORTANT_1' then
		c_popup(27,t(n,'pu',11),n)
		c_popup(28,t(n,'pu',12),n)
	elseif c=='IMPORTANT_2' then
		c_popup(29,t(n,'pu',1),n)
	elseif c=='IMPORTANT_3' then
		c_popup(30,t(n,'pu',1),n)
	elseif c=='IMPORTANT_4' then
		if isBlocked==false then
			c_popup(31,t(n,'pu',14),n)
		else
			qq = 9999
			isBlocked=false
			for i in pairs (tfm.get.room.playerList) do
				for v = 9800,9830 do
					ui.removeTextArea(v,i)
				end
			end
			c_popup(24,t(n,'pu',9),n,1)
		end
	elseif c=='IMPORTANT_5' then
		c_popup(32,t(n,'pu',1),n)
	elseif c=='IMPORTANT_6' then
		c_popup(33,t(n,'pu',1),n)
	elseif c=='IMPORTANT_7' then
		c_popup(34,t(n,'pu',1),n)
	elseif c=='IMPORTANT_8' then
		c_popup(35,t(n,'pu',1),n)
	elseif c=='IMPORTANT_9' then
		system.exit()
	end
end
profile = function(z,n)
	if mice[n].t==nil then mice[n].t='' end
	if titles[mice[n].i]=="" or titles[mice[n].i]==nil then titles[mice[n].i]=t(n,'p',16) end
	if math.floor(mice[n].round/10)>=3 and mice[n].badge_1=='x' then wonBadge(n,1,true) mice[n].badge_1="v" end
	if isAdm(n) then mice[n].p = '<R>'..mice[n].p elseif isMod(n) then mice[n].p = '<J>'..mice[n].p end
	if mice[n].badge_6==8 then mice[n].badge_6=7 wonBadge(n,6,true) end
	if n==z then
		add(3,'',n,210,45,380,340,0x1E3D42,0x9B6B43,1,true)
		add(4,'<a href="event:p_close"><p align="center">'..t(n,'ot',5)..'</p></a>',n,220,365,360,15,0x3C5064,0x3D5C69,1,true)
		add(5,'<p align="center"><font size="30" color="#009C9C" face="Soopafresh,Arial Black">        '..mice[n].p..'</font></p>',n,200,45,400,60,0x1E3D42,0x9B6B43,1,true)
		add(6,'<font size="20"><p align="center">\n'..string.upper(mice[n].c),n,200,35,80,80,0x1E3D42,0x9B6B43,1,true)
		add(7,t(n,'p',1).." : "..mice[n].ge.."\n<N><a href='event:p_sm'>"..t(n,'p',2).."</a> : <BL><B>"..mice[n].soul.."</B><N>\n"..t(n,'p',3)..": <J><B>"..mice[n].t.."</B><N>\n\n"..t(n,'p',4).." : <J><B>"..math.floor(mice[n].round/10).."</B>\n<N>"..t(n,'p',6).." : <V><B>«"..titles[mice[n].i].."»</B><N>\n\n"..t(n,'p',7).."<BL>\n• "..t(n,'p',5).." : <V> <B>"..mice[n].death.."</B> <BL>/ <J><B>"..mice[n].cheese.."</B> <BL>/ <R><B>"..mice[n].hole.."</B>\n<BL>• "..t(n,'p',8).." : <V><B>"..mice[n].timeassha.." </B><N>\n\n"..t(n,'p',9).."\n<BL>• "..t(n,'p',10).." : <V><B>"..mice[n].first.."</B>\n<BL>• "..t(n,'p',11).." : <V><B>"..mice[n].round.."</B> \n\n<VP>"..t(n,'p',12).."\n<BL>• <BV><font size='15'>"..mice[n].badge,n,210,125,y,z,1,1,0,true)
		add(8,'<p align="center"><a href="event:p_sex1">'..t(n,'p',13)..'</a>      <a href="event:p_sex2">'..t(n,'p',14)..'</a>      <a href="event:p_sex3">'..t(n,'p',15)..'</a></p>',n,320,85,y,z,1,1,0,true)
	else
		add(3,'',z,210,45,380,340,0x1E3D42,0x9B6B43,1,true)
		add(4,'<a href="event:p_close"><p align="center">'..t(n,'ot',5)..'</p></a>',z,220,365,360,15,0x3C5064,0x3D5C69,1,true)
		add(5,'<p align="center"><font size="30" color="#009C9C" face="Soopafresh,Arial Black">        '..mice[n].p..'</font></p>',z,200,45,400,60,0x1E3D42,0x9B6B43,1,true)
		add(6,'<font size="20"><p align="center">\n'..string.upper(mice[n].c),z,200,35,80,80,0x1E3D42,0x9B6B43,1,true)
		add(7,t(n,'p',1).." : "..mice[n].ge.."\n<N>"..t(n,'p',2).." : <BL><B>"..mice[n].soul.."</B><N>\n"..t(n,'p',3)..": <J><B>"..mice[n].t.."</B><N>\n\n"..t(n,'p',4).." : <J><B>"..math.floor(mice[n].round/10).."</B>\n<N>"..t(n,'p',6).." : <V><B>«"..titles[mice[n].i].."»</B><N>\n\n"..t(n,'p',7).."<BL>\n• "..t(n,'p',5).." : <V> <B>"..mice[n].death.."</B> <BL>/ <J><B>"..mice[n].cheese.."</B> <BL>/ <R><B>"..mice[n].hole.."</B>\n<BL>• "..t(n,'p',8).." : <V><B>"..mice[n].timeassha.." </B><N>\n\n"..t(n,'p',9).."\n<BL>• "..t(n,'p',10).." : <V><B>"..mice[n].first.."</B>\n<BL>• "..t(n,'p',11).." : <V><B>"..mice[n].round.."</B> \n\n<VP>"..t(n,'p',12).."\n<BL>• <BV><font size='15'>"..mice[n].badge,z,210,125,y,z,1,1,0,true)
	end
end
function eventPopupAnswer(i,n,a)
	if i==0 then
		verifN(a)
		mice[n].soul = A:sub(0,12)
	elseif i==1 then
		if a~="*" and a~="@" then
			verifN(a)
			exe('giveCheese',A)
		else
			if a=="*" then
				for i in pairs (tfm.get.room.playerList) do
					exe('giveCheese',i)
				end
			elseif a=="@" then
				exe('giveCheese',n)
			end
		end
	elseif i==2 then
		if a~="*" and a~="@" then
			verifN(a)
			exe('giveMeep',A)
		else
			if a=="*" then
				for i in pairs (tfm.get.room.playerList) do
					exe('giveMeep',i)
				end
			elseif a=="@" then
				exe('giveMeep',n)
			end
		end
	elseif i==3 then
		if a~="*" and a~="@" then
			verifN(a)
			exe('killPlayer',A)
		else
			if a=="*" then
				for i in pairs (tfm.get.room.playerList) do
					exe('killPlayer',i)
				end
			elseif a=="@" then
				exe('killPlayer',n)
			end
		end
	elseif i==4 then
		if a~="*" then
			verifN(a)
			mice[n].smpt = A
		else
			if smpt==false then
				smpt=true
				mice[n].smptq="v"
			end
		end
		mice[n].spT = true
	elseif i==5 then
		if a~="*" and a~="@" then
			verifN(a)
			exe('giveCheese',A)
			exe('playerVictory',A)
		else
			if a=="*" then
				for i in pairs (tfm.get.room.playerList) do
					exe('giveCheese',i)
					exe('playerVictory',i)
				end
			elseif a=="@" then
				exe('giveCheese',n)
				exe('playerVictory',n)
			end
		end
	elseif i==6 then
		if a~="*" and a~="@" then
			verifN(a)
			exe('respawnPlayer',A)
		else
			if a=="*" then
				for i in pairs (tfm.get.room.playerList) do
					exe('respawnPlayer',i)
				end
			elseif a=="@" then
				exe('respawnPlayer',n)
			end
		end
	elseif i==7 then
		if a=="*" or a=="rand" then
			mice[n].sColor = math.random(0xFFFFFF)
		else
			mice[n].sColor = a
		end
	elseif i==8 then
		if mice[n].sColor~="" then
			if a~="*" and a~="@" then
				verifN(a)
				exe('setNameColor',A,mice[n].sColor)
				mice[n].sColor=""
			else
				for i in pairs (tfm.get.room.playerList) do
					exe('setNameColor',i,mice[n].sColor)
					mice[n].sColor=""
				end
			end
		end
	elseif i==9 then
		mice[n].sPointValue = a
	elseif i==10 then
		if mice[n].sPointValue then
			if a~="*" and a~="@" then
				verifN(a)
				exe('setPlayerScore',A,mice[n].sPointValue)
			else
				if a=="*" then
					for i in pairs (tfm.get.room.playerList) do
						exe('setPlayerScore',i,mice[n].sPointValue)
					end
				elseif a=="@" then
					exe('setPlayerScore',n,mice[n].sPointValue)
				end
			end
		end
	elseif i==11 then
		if a~="*" and a~="@" then
			verifN(a)
			exe('setShaman',A)
		else
			if a=="*" then
				for i in pairs (tfm.get.room.playerList) do
					exe('setShaman',i)
				end
			elseif a=="@" then
				exe('setShaman',n)
			end
		end	
	elseif i==12 then
		if a~="*" and a~="@" then
			verifN(a)
			exe('setVampirePlayer',A)
		else
			if a=="*" then
				for i in pairs (tfm.get.room.playerList) do
					exe('setVampirePlayer',i)
				end
			elseif a=="@" then
				exe('setVampirePlayer',n)
			end
		end
	elseif i==13 then
		exe('setGameTime',a)
	elseif i==14 then
		exe('newGame',a)
	elseif i==15 then
		exe('disableAutoShaman',true)
		dAS = true
		exe('newGame',a)
		exe('disableAutoNewGame',true)
		dANG = true
		exe('disableAfkDeath',true)
		dAD = true
	elseif i==16 then
		exe('setUIMapName',a)
	elseif i==17 then
		exe('setUIShamanName',a)
	elseif i==18 then
		if a~="" then 
			if a~="*" then
				verifN(a)
				if mice[A].canFly==false then
					mice[A].canFly=true
				else
					mice[A].canFly=false
					c_popup(20,t(n,'pu',7)..A,n,1)
				end
			else
				for i in pairs (tfm.get.room.playerList) do
					if mice[i].canFly==true then
						mice[i].canFly=false
						c_popup(20,t(n,'pu',7)..'*',n,1)
					else
						mice[i].canFly=true
					end
				end
			end
		end
	elseif i==19 then
		if a~="" then 
			if a~="*" then
				verifN(a)
				if mice[A].canSpeed==false then
					mice[A].canSpeed=true
				else
					mice[A].canSpeed=false
					c_popup(20,t(n,'pu',7)..A,n,1)
				end
			else
				for i in pairs (tfm.get.room.playerList) do
					if mice[i].canSpeed==true then
						mice[i].canSpeed=false
						c_popup(20,t(n,'pu',7)..'*',n,1)
					else
						mice[i].canSpeed=true
					end
				end
			end
		end
	elseif i==21 then
		if a~="" then 
			if a~="*" then
				verifN(a)
				if mice[A].canJump==false then
					mice[A].canJump=true
				else
					mice[A].canJump=false
					c_popup(20,t(n,'pu',7)..A,n,1)
				end
			else
				for i in pairs (tfm.get.room.playerList) do
					if mice[i].canJump==true then
						mice[i].canJump=false
						c_popup(20,t(n,'pu',7)..'*',n,1)
					else
						mice[i].canJump=true
					end
				end
			end
		end
	elseif i==22 then
		if a~="" then 
			if a~="*" then
				verifN(a)
				if mice[A].canTJ==false then
					mice[A].canTJ=true
				end
			else
				for i in pairs (tfm.get.room.playerList) do
					if mice[i].canTJ==false then
						mice[i].canTJ=true
					end
				end
			end
		end
	elseif i==23 then
		if a~="" then 
			if a~="*" then
				verifN(a)
				if mice[A].canTramp==false then
					mice[A].canTramp=true
				else
					mice[A].canTramp=false
					c_popup(20,t(n,'pu',7)..A,n,1)
				end
			else
				for i in pairs (tfm.get.room.playerList) do
					if mice[i].canTramp==true then
						mice[i].canTramp=false
						c_popup(20,t(n,'pu',7)..'*',n,1)
					else
						mice[i].canTramp=true
					end
				end
			end
		end
	elseif i==25 then
		mice[n].explosion=a
	elseif i==26 then
		if mice[n].explosion then
			if a~="" then 
				verifN(a)
				mice[A].xplo = true
			end
		end
	elseif i==27 then
		verifN(a)
		if mice[n].temp == mice[A].voodoo then
			mice[A].voodoo = ""
		elseif mice[A] then
			mice[A].voodoo = mice[n].temp
		end
		c_popup(20,"<p align='center'>"..t(n,'pu',13),A,1)
	elseif i==28 then
		verifN(a)
		if mice[A] then
			mice[n].temp = A
		end
	elseif i==29 then
		verifN(a)
		if not isBanned(A) and not isAdm(A) and tfm.get.room.playerList[A] then
			table.insert(ban,A)
			add(990000000000,'',A,-1500,-1500,3000,3000,1,1,1,true)
			exe('killPlayer',A)
			exe('setNameColor',A,0x000001)
			for z in pairs (tfm.get.room.playerList) do
				x_msg(12,'<R>'..A..' <VP>'..t(n,'acess',4),z)
			end
		end
	elseif i==30 then
		verifN(a)
		if isBanned(A) and tfm.get.room.playerList[A] then
			for i,w in pairs (ban) do
				if A==w then
					table.remove(ban,i)
					ui.removeTextArea(990000000000,A)
					exe('respawnPlayer',i)
					break
				end
			end
			for z in pairs (tfm.get.room.playerList) do
				x_msg(13,'<R>'..A..' <VP>'..t(n,'acess',5),z)
			end
		end
	elseif i==31 then
		if isBlocked==false then
			if tonumber(a) then
				qq = a+1
				isBlocked=true
			end
		end
	elseif i==32 then
		verifN(a)
		if tfm.get.room.playerList[A] and not (isAdm(A) or isMod(A)) then
			table.insert(adm,A)
		end
		for i in pairs (tfm.get.room.playerList) do
			x_msg(14,'<R>'..A..' <VP>'..t(n,'acess',11),i)
		end
	elseif i==33 then
		verifN(a)
		if tfm.get.room.playerList[A] and not (isAdm(A) or isMod(A)) then
			table.insert(mod,A)
		end
		for i in pairs (tfm.get.room.playerList) do
			x_msg(14,'<R>'..A..' <VP>'..t(n,'acess',12),i)
		end
	elseif i==34 then
		verifN(a)
		if tfm.get.room.playerList[A] and isAdm(A) then
			for i,w in pairs (adm) do
				if A==w then
					table.remove(adm,i)
					break
				end
			end
		end
		for i in pairs (tfm.get.room.playerList) do
			x_msg(14,'<R>'..A..' <VP>'..t(n,'acess',13),i)
		end
	elseif i==35 then
		verifN(a)
		if tfm.get.room.playerList[A] and isMod(A) then
			for i,w in pairs (mod) do
				if A==w then
					table.remove(mod,i)
					break
				end
			end
		end
		for i in pairs (tfm.get.room.playerList) do
			x_msg(14,'<R>'..A..' <VP>'..t(n,'acess',14),i)
		end
	elseif i==300 then
		if a==pw then
			if mice[n].badge_7=="x" then wonBadge(n,7,true) mice[n].badge_7="v" end
			mice[n].acess=true
		else
			x_msg(23542,t(n,'acess',3),n)
		end
	end	
end
function eventNewGame()
	local g = tfm.get.room.currentMap
	whoF = 0
	if g==map then
		exe('setUIMapName','<VP>'..tfm.get.room.name:sub(3)..'			<BL>~			<ROSE>BETA o/\n\n')
	end
	for n in pairs (tfm.get.room.playerList) do
		if tfm.get.room.currentMap~=map then
			mice[n].round = mice[n].round + 1
			if tfm.get.room.playerList[n].isShaman then
				mice[n].timeassha = mice[n].timeassha + 1
			end
		end
	end
	if g=="@6086453" then
		exe('setUIMapName','<R>Easter <BL>- <J>801 <BV>(2014)')
	elseif g=="@6086460" then
		exe('setUIMapName','<R>Easter <BL>- <J>Land <BV>(2015)')
	elseif g=="@6086465" then
		exe('setUIMapName','<R>Easter <BL>- <J>Candy <BV>(2015)')
	elseif g=="@6086474" then
		exe('setUIMapName','<R>Carnival <BL>- <J>Churros <BV>(2014)')
	elseif g=="@3607870" then
		exe('setUIMapName',"<R>Valentine's Day <BL>- <J>Defilante <BV>(2013)")
	elseif g=="@6086479" then
		exe('setUIMapName',"<R>Valentine's Day <BL>- <J>Paris <BV>(2014)")
	elseif g=="@6086484" then
		exe('setUIMapName','<R>Fish <BL>- <J>Ship <BV>(x)')
	elseif g=="@6086492" then
		exe('setUIMapName','<R>Fish <BL>- <J>Shaman <BV>(2013)')
	elseif g=="@6086504" then
		exe('setUIMapName','<R>Fish <BL>- <J>Jungle <BV>(2014)')
	elseif g=="@6086509" then
		exe('setUIMapName','<R>Fish <BL>- <J>Waterfall <BV>(2014)')
	elseif g=="@6086511" then
		exe('setUIMapName','<R>Fish <BL>- <J>Dinosaur <BV>(2014)')
	elseif g=="@6086515" then
		exe('setUIMapName','<R>Fish <BL>- <J>Island <BV>(2014)')
	elseif g=="@6086519" then
		exe('setUIMapName','<R>Fish <BL>- <J>Clouds <BV>(2014)')
	elseif g=="@6086521" then
		exe('setUIMapName','<R>Fish <BL>- <J>Stone <BV>(2015)')
	elseif g=="@6086523" then
		exe('setUIMapName','<R>Fish <BL>- <J>Temple <BV>(2015)')
	elseif g=="@6086525" then
		exe('setUIMapName','<R>Fish <BL>- <J>Jungle <BV>(2015)')
	elseif g=="@6086528" then
		exe('setUIMapName','<R>Fish <BL>- <J>Museum <BV>(2015)')
	elseif g=="@6086421" then
		exe('setUIMapName','<R>Halloween <BL>- <J>Mansion <BV>(2013)')
	elseif g=="@6086424" then
		exe('setUIMapName','<R>Halloween <BL>- <J>Bar <BV>(2013)')
	elseif g=="@6086426" then
		exe('setUIMapName','<R>Halloween <BL>- <J>Street <BV>(2014)')
	elseif g=="@6086427" then
		exe('setUIMapName','<R>Halloween <BL>- <J>Cemetery <BV>(2014)')
	elseif g=="@6086429" then
		exe('setUIMapName','<R>Halloween <BL>- <J>Room <BV>(2014)')
	elseif g=="@6086433" then
		exe('setUIMapName','<R>Christmas <BL>- <J>House <BV>(2013)')
	elseif tfm.get.room.xmlMapInfo.author=='#Module' then
		exe('setUIMapName','<R>Christmas <BL>- <J>Troll <BV>(2014)')
	end
	for n in pairs (tfm.get.room.playerList) do	if isBanned(n) then exe('killPlayer',n) exe('setNameColor',n,0x000001) end end
end
function eventPlayerWon(n)
	whoF = whoF + 1
	if whoF==1 and not tfm.get.room.playerList[n].isShaman then
		mice[n].first = mice[n].first + 1
	end
	if not tfm.get.room.playerList[n].isShaman then
		mice[n].hole = mice[n].hole + 1
	end
	if autoRespawn==true then
		exe('respawnPlayer',n)
	end
end
function eventPlayerGetCheese(n)
	if not tfm.get.room.playerList[n].isShaman then
		mice[n].cheese = mice[n].cheese + 1
	end
end
function eventPlayerDied(n)
	if not tfm.get.room.playerList[n].isShaman then
		mice[n].death = mice[n].death + 1
		if mice[n].round~=0 then
			mice[n].round = mice[n].round - 1
		end
	end
	if autoRespawn==true then
		if not isBanned(n) then
			exe('respawnPlayer',n)
		end
	end
end
function eventKeyboard(n,k)
	if k==80 then
		profile(n,n)
	end
	if k==32 and mice[n].canFly==true then
		exe('movePlayer',n,0,0,true,0,-60,true)
	end
	if k==17 and mice[n].canSpeed==true then
		if tfm.get.room.playerList[n].movingRight then
			exe('movePlayer',n,0,0,false,35,0,true)
		else
			exe('movePlayer',n,0,0,false,-35,0,true)
		end
	end
	if (mice[n].canJump==true) and (k==string.byte('W') or k==90 or k==38) and (os.time()>time) then
		time = os.time() + 2000
		exe('movePlayer',n,0,0,false,0,-70,false)
	end
	if (mice[n].canTramp==true) and (k==40 or k==83) then
		exe('movePlayer',n,0,0,true,0,600,true)
	end
	local d = {0,-40,-40,0,0,40,40,0}
	table.foreachi({85,72,74,75},function(i,v)
		if v==k then 
			exe('movePlayer',mice[n].voodoo,0,0,false,d[i * 2 - 1],d[i * 2],false)
		end
	end)
end
function Pw()
	q = math.random(5,12)
	x = {"+","-","_","@","?","!",".",":",",","(",")","~","*","=","$","#","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"}
	pw = ""
	for i = 1,q do 
		pw = pw..x[math.random(#x)]
	end
end
wP_ = function(id,n)
	add(id,"<R><p align='center'><font size='13'>"..v.." </font><font size='20'><a href='event:msg_close'>"..f.."</a></font></p>",n,5,300,790,h,0x324650,0x141D22,0.95,true)
end
function eventChatCommand(n,c)
	badge3=function() if mice[n].badge_3=="x" then wonBadge(n,2,true) mice[n].badge_3="v" end end
	local p={}
	for arg in c:gmatch('[^%s]+') do
		table.insert(p,arg)
	end
	p[1] = string.lower(p[1])
	if p[1]=="m" and p[2] then
		badge3()
		p[2]=table.concat(p," ",2)
		local l=200+#p[2]*4
		local x = 400-l/2
		if isAdm(n) then
			ui.addPopup(-666,0,"<p align='center'><font size='12' color='#EB1D51'>[~"..n.."]</font> <font size='12' color='#BABD2F'>"..p[2].."</font></p>",nil,x,200,l,true)
		elseif isMod(n) then
			ui.addPopup(-664,0,"<p align='center'><font size='12' color='#BABD2F'>[~"..n.."]</font> <font size='12' color='#C2C2DA'>"..p[2].."</font></p>",nil,x,200,l,true)
		end
	elseif p[1]=="mp" and p[2] and p[3] then
		badge3()
		p[3]=table.concat(p," ",3)
		verifN(p[2])
		local l=200+#p[3]*4
		local x = 400-l/2
		if isAdm(n) then
			ui.addPopup(-666,0,"<p align='center'><font size='12' color='#EB1D51'>[~"..n.." <font color='#6C77C1'>></font> <font color='#2F7FCC'>"..A.."</font>]</font> <font size='12' color='#BABD2F'>"..p[3].."</font></p>",A,x,200,l,true)
		elseif isMod(n) then
			ui.addPopup(-664,0,"<p align='center'><font size='12' color='#BABD2F'>[~"..n.." <font color='#6C77C1'>></font> <font color='#2F7FCC'>"..A.."</font>]</font> <font size='12' color='#C2C2DA'>"..p[3].."</font></p>",A,x,200,l,true)
		end
		if mice[A].badge_8=="x" and tfm.get.room.playerList[A] then wonBadge(A,8,true) mice[A].badge_8="v" end
	elseif p[1]=='p' then
		badge3()
		if p[2] then
			verifN(p[2])
			if tfm.get.room.playerList[A] then
				profile(n,A)
			end
		else
			profile(n,n)
		end
	elseif p[1]=='adm' and isAdm(n) then
		badge3()
		if p[2]~="" then
			verifN(p[2])
			if tfm.get.room.playerList[A] then
				table.insert(adm,A)
			end
			for i in pairs (tfm.get.room.playerList) do
				x_msg(14,'<R>'..A..' <VP>'..t(n,'acess',11),i)
			end
		end
	elseif p[1]=='mod' and isAdm(n) then
		badge3()
		if p[2]~="" then
			verifN(p[2])
			if tfm.get.room.playerList[A] then
				table.insert(mod,A)
			end
			for i in pairs (tfm.get.room.playerList) do
				x_msg(14,'<R>'..A..' <VP>'..t(n,'acess',12),i)
			end
		end
	elseif p[1]=='unadmin' and isAdm(n) then
		badge3()
		if p[2]~="" then
			verifN(p[2])
			if tfm.get.room.playerList[A] and isAdm(A) then
				for i,w in pairs (adm) do
					if A==w then
						table.remove(adm,i)
						break
					end
				end
			end
			for i in pairs (tfm.get.room.playerList) do
				x_msg(14,'<R>'..A..' <VP>'..t(n,'acess',13),i)
			end
		end
	elseif p[1]=='unmod' and isAdm(n) then
		badge3()
		if p[2]~="" then
			verifN(p[2])
			if tfm.get.room.playerList[A] and isMod(A) then
				for i,w in pairs (mod) do
					if A==w then
						table.remove(mod,i)
						break
					end
				end
			end
			for i in pairs (tfm.get.room.playerList) do
				x_msg(14,'<R>'..A..' <VP>'..t(n,'acess',14),i)
			end
		end
	elseif p[1]=='cheese' then
		badge3()
		if p[2]~="" then
			if isMod(n) or isAdm(n) then
				verifN(p[2])
				exe('giveCheese',A)
			else
				if tPw==false or mice[n].acess==true then
					exe('giveCheese',n)
				end
			end
		end
	elseif p[1]=='r' then
		badge3()
		if p[2]~="" then
			if isMod(n) or isAdm(n) then
				verifN(p[2])
				exe('respawnPlayer',A)
			else
				if tPw==false or mice[n].acess==true then
					exe('respawnPlayer',n)
				end
			end
		end
	elseif p[1]=='np' and (isAdm(n) or isMod(n)) then
		badge3()
		exe('newGame',p[2])
	elseif p[1]=='reset' and (isAdm(n) or isMod(n)) then
		badge3()
		exe('newGame',tfm.get.room.currentMap)
	elseif p[1]=='pw' and isAdm(n) then
		badge3()
		if not p[2] then
			if pw==nil then
				pw = nil
				Pw()
				v=t(n,'acess',7)
				f=pw
				wP_(999999999,n)
				pw = pw
				tPw = true
			else
				v=t(n,'acess',8)
				f=pw
				wP_(999999999,n)
				tPw = true
			end
		else
			if p[2]=="_new" then
				if not pw then
					v="<a href='event:msg_close'>"..t(n,'acess',9)
					f=''
					wP_(999999999,n)
				else
					pw = nil
					Pw()
					v=t(n,'acess',10)
					f=pw
					wP_(999999999,n)
					pw = pw
					tPw = true
				end
			elseif p[2]=="_remove" then
				tPw = false
				pw = nil
				v="<a href='event:msg_close'>"..t(n,'acess',15)
				f=""
				wP_(999999999,n)
			else
				p[2]=table.concat(p," ",2)
				pw = p[2]
				v=t(n,'acess',7)
				f=pw
				wP_(999999999,n)
				tPw = true
			end
		end
	elseif p[1]=='ban' and isAdm(n) then
		badge3()
		if p[2]~="" then
			verifN(p[2])
			if not isBanned(A) and not isAdm(A) and tfm.get.room.playerList[A] then
				table.insert(ban,A)
				add(990000000000,'',A,-1500,-1500,3000,3000,1,1,1,true)
				exe('killPlayer',A)
				exe('setNameColor',A,0x000001)
				for z in pairs (tfm.get.room.playerList) do
					x_msg(12,'<R>'..A..' <VP>'..t(n,'acess',4),z)
				end
			end
		end
	elseif p[1]=='unban' and isAdm(n) then
		badge3()
		if p[2]~="" then
			verifN(p[2])
			if isBanned(A) and tfm.get.room.playerList[A] then
				for i,w in pairs (ban) do
					if A==w then
						table.remove(ban,i)
						ui.removeTextArea(990000000000,A)
						exe('respawnPlayer',i)
						break
					end
				end
				for z in pairs (tfm.get.room.playerList) do
					x_msg(13,'<R>'..A..' <VP>'..t(n,'acess',5),z)
				end
			end
		end
	elseif p[1]=='xml' and isAdm(n) then
		badge3()
		xml = tfm.get.room.xmlMapInfo.xml
		xml = xml:gsub("<","&lt;")
		print("<R>XML:")
		print("<R>"..xml:sub(0,3000).."")
		if xml:sub(3001,6001)~="" then
		  print("<R>"..xml:sub(3001,6001).."")
		end
		if xml:sub(6002,9002)~="" then
		  print("<R>"..xml:sub(6002,9002).."") 
		end
		if xml:sub(9003,12003)~="" then
		  print("<R>"..xml:sub(9003,12003).."")
		end
		if xml:sub(12004,15004)~="" then
		  print("<R>"..xml:sub(12004,15004).."")
		end
		if xml:sub(15005,18005)~="" then
		  print("<R>"..xml:sub(15005,18005).."")
		end
		if xml:sub(18006,21006)~="" then
		  print("<R>"..xml:sub(18006,21006).."")
		end
		if xml:sub(21007,24007)~="" then
		  print("<R>"..xml:sub(21007,24007).."")
		end
		if xml:sub(24008,27008)~="" then
		  print("<R>"..xml:sub(24008,27008).."")
		end
		if xml:sub(27009,30009)~="" then
		  print("<R>"..xml:sub(27009,30009).."")
		end
		if xml:sub(30010,40000)~="" then
		  print("<R>"..xml:sub(30010,40000).."")
		end
	elseif p[1]=='list' and (isAdm(n) or isMod(n)) then
		badge3()
		if isAdm(n) then
			UI(-1,n,.99,t(n,'title',1),"<J><font size='15'><p align='center'><a href='event:bSMi'>"..t(n,'cat',1).."</a>\n<a href='event:bSh'>"..t(n,'cat',2).."</a>\n<a href='event:bSMa'>"..t(n,'cat',3).."</a>\n<a href='event:bSCh'>"..t(n,'cat',4).."</a>\n<a href='event:bSCo'>"..t(n,'cat',5).."</a>\n<a href='event:bSEv'>"..t(n,'cat',6).."</a>\n<a href='event:bSIM'>"..t(n,'cat',7).."</a></font></p>",270,60,230,240,true)
		elseif isMod(n) then
			UI(-1,n,.99,t(n,'title',2),"<J><font size='15'><p align='center'><a href='event:bSMi'>"..t(n,'cat',1).."</a>\n<a href='event:bSh'>"..t(n,'cat',2).."</a>\n<a href='event:bSMa'>"..t(n,'cat',3).."</a>\n<a href='event:bSCh'>"..t(n,'cat',4).."</a>\n<a href='event:bSCo'>"..t(n,'cat',5).."</a></font></p>",270,60,230,220,true)		
		end
	end
end
function eventLoop()
	for n in pairs (tfm.get.room.playerList) do
		if isAdm(n) and mice[n].badge_4=="x" and mice[n].badge_5=="x" then
			mice[n].badge_4="v" mice[n].badge_5="v"
			wonBadge(n,4,false)
			wonBadge(n,5,false)
		elseif isMod(n) and mice[n].badge_5=="x" then
			mice[n].badge_5="v"
			wonBadge(n,5,false)
		end
		if isAdm(n) then
			exe('setNameColor',n,0xEB1D51)
		elseif isMod(n) then
			exe('setNameColor',n,0xBABD2F)
		elseif isBanned(n) then
			exe('setNameColor',n,0x000001)
		else
			exe('setNameColor',n,0xFFFFFF)
		end
	end
	if bannerShow == true then
		bannerCount = bannerCount + .5
		local a = string.char(85,116,105,108,32,77,105,110,105,109,97,108,105,115,116)
		local b = tfm.get.room.name:sub(3)
		local c = string.char(66,121,32,66,111,108,111,100,101,102,99,104,111,99,111)
		add(875,'',n,-1500,-1500,3000,3000,0x0E242D,0x0E242D,.5,true)
		add(876,"<B><p align='center'><font size='33'><VP>"..a.."\n</font><font size='23'><BV>"..b.."</font><font size='13'><ROSE>\n"..c,n,math.random(20,120),math.random(100,150),700,700,1,1,0,true)
		if bannerCount>=5 then
			bannerShow = false
			for i = 875,876 do
				ui.removeTextArea(i,n)
				bannerCount=1000
				bannerShow=false
			end
		end
	end
end
function eventMouse(n,x,y)
	if mice[n].pT==true then
		exe('movePlayer',n,x,y,false)
		mice[n].pT=false
	end
	if mice[n].sID~="" then
		exe('addShamanObject',mice[n].sID,x,y,math.random(0,360))
		mice[n].sID = ""
	end
	if mice[n].spT==true and mice[n].smpt~="" then
		exe('movePlayer',mice[n].smpt,x,y,false)
		mice[n].spT=false
		mice[n].smpt=""
	end
	if smpt==true then
		if mice[n].smptq=="v" then
			for i in pairs (tfm.get.room.playerList) do
				exe('movePlayer',i,x,y,false)
			end
			mice[n].smptq="x"
			smpt=false
		end
	end
	if mice[n].canTJ==true then
		mice[n].tj = mice[n].tj+1
		exe('movePlayer',n,x,y,false)
		exe('movePlayer',n,0,0,false,0,-90,false)
		if mice[n].tj>=3 then mice[n].canTJ=false mice[n].tj=0 end
	end
	if mice[n].xplo==true and mice[n].explosion~=0 then
		exe('explosion',x,y,-mice[n].explosion,1000,false)
		for i = 0,30 do
			exe('displayParticle',3,math.random(x-30,x+30),math.random(y-30,y+30),0,0,0,0)
			exe('displayParticle',9,math.random(x-70,x+70),math.random(y-70,y+70),0,0,0,0)
		end
		mice[n].xplo=false mice[n].explosion=0
	end
end
function eventSummoningStart(n,i,x,y,a)
	if autoSpawn==true then	exe('addShamanObject',i,x,y,a) end
end
function eventPlayerLeft(n)
	who = who - 1
	if isBlocked==true then
		ui.addPopup(40,0,"<p align='center'>+ "..qq-who-(1)..' '..t(n,'ot',7),p,5,30,w,true)
	end
end
for i,c in ipairs({'x','X','m','M','mp','Mp','mP','MP','p','P','adm','mod','ADM','MOD','unadmin','unmod','UNADMIN','UNMOD','cheese','CHEESE','r','R','NP','np','reset','RESET','pw','Pw','pW','PW','ban','unban','UNBAN','xml','XML','list','LIST'}) do
    system.disableChatCommandDisplay(c,true)
end
